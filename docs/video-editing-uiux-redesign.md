# Web 视频剪辑（新建/详情）UI/UX 重设计 v1（确认版）

> 目的：基于已完成的任务流程验证，对“新建任务 → 任务详情”进行信息重构与交互重设计，降低认知负担，提升关键路径效率。本方案落实到 `web/` 现有代码，不改变后端接口与数据结构。

## 用户确认要点（Decision Log）
- 详情页布局选择：采用「方案 B」— 主区 Tabs + 底部日志（可展开为抽屉），不使用右侧常驻日志。
- 关键词输入：使用 chip（标签）输入交互，替换大段 textarea。
- 创建页分组默认展开：基础、素材、文案、音频与字幕展开；高级收起。
- 预设：提供 3 个顶部预设 chip，可一键写入画幅/时长/拼接/转场默认值。
- 二次动作：任务详情右侧动作“保存为模板/复刻为新任务”先展示入口（占位），功能稍后实现。

---

## 新建任务（/edit/video/create）

布局：两栏（左表单 + 右预览/摘要）+ 页底 Sticky 主操作。限制输入宽度与行数，表单分组折叠。

```
┌───────────────────────────────────────────────────────────────────────────────┐
│ 面包屑：编辑 / 视频 / 新建        预设： [竖屏快节奏] [横屏解说] [方形社媒]       │
└───────────────────────────────────────────────────────────────────────────────┘
┌───────────────────────────────────────┬───────────────────────────────────────┐
│ 左栏（表单）                           │ 右栏（预览 / 摘要 / 行动）              │
│ ─ 基础（展开）                         │ 预览（占位播放器/缩略图）               │
│   主题: [  输入框(适中宽度)   ]         │ [▶︎ 预览] [刷新分镜]                     │
│   画幅: (9:16 • 16:9 • 1:1)            │ 分镜预估：12 段 ≈ 60s                   │
│   单段时长: [ 5s ▾ ]  数量: [ 1 ▾ ]     │ 参数摘要：                               │
│   拼接: [ 随机 ▾ ]  转场: [ 无 ▾ ]      │  - 主题/画幅/拼接/转场                   │
│                                         │  - 素材源与数量                          │
│ ─ 素材（展开）                          │  - TTS/配音/BGM                          │
│   来源: (Pexels • Pixabay • 本地)        │ ─ Sticky 主操作（与页底一致）            │
│   [选择/上传素材]  已选 N 个             │ [仅生成分镜] [一键生成视频] [取消]        │
│                                         │                                         │
│ ─ 文案（展开）                          │                                         │
│   脚本: [ 行数=4 的 textarea ]          │                                         │
│   关键词: [ chip 输入(标签) ]            │                                         │
│   语言: [ Auto ▾ ]                      │                                         │
│                                         │                                         │
│ ─ 音频与字幕（展开）                     │                                         │
│   TTS: [ azure ▾ ]  声音: [ 下拉 ]       │                                         │
│   语速: [1.0 ▾ ]  音量: [0.8 ▾ ]         │                                         │
│   BGM: (无 • 随机 • 自定义[选择]) 音量…  │                                         │
│   [字幕开关]                             │                                         │
│                                         │                                         │
│ ─ 高级 ▾（收起）                         │                                         │
│   其他进阶参数…                          │                                         │
└───────────────────────────────────────┴───────────────────────────────────────┘
┌───────────────────────────────────────────────────────────────────────────────┐
│ Sticky Footer： [仅生成分镜]   [一键生成视频]   [取消]                            │
└───────────────────────────────────────────────────────────────────────────────┘
```

交互规则
- 预设：
  - 竖屏快节奏 → 9:16 / 5s / 随机拼接 / 无转场
  - 横屏解说 → 16:9 / 5s / 顺序拼接 / 淡入淡出（FadeIn/FadeOut）
  - 方形社媒 → 1:1 / 4s / 随机拼接 / 无转场
- chip 输入：逗号/回车创建标签；Backspace 删除；最多 10 个，超限提示。
- 分组：默认展开“基础/素材/文案/音频与字幕”，仅“高级”收起；切换状态持久化到 `localStorage`。
- Sticky 主操作：右栏与页底均提供；移动端仅显示页底。
- 素材上传/选择：继承现有逻辑（本地上传进度、Pexels/Pixabay 选择），右栏摘要实时更新选中数。

---

## 任务详情（/edit/video/tasks/[id]）

布局：头部统一状态条 + 主区 Tabs + 底部日志（方案 B）。日志默认收起为一行预览，可展开为抽屉。

```
┌───────────────────────────────────────────────────────────────────────────────┐
│ ← 返回   任务 #A1B2C3    状态: 处理中   进度 42% [██████░░░░]   [重试] [删除]  │
│ 失败时：显示错误条；成功时：显示 [下载] [复制链接] [打开输出]                    │
└───────────────────────────────────────────────────────────────────────────────┘
┌───────────────────────────────────────────────────────────────────────────────┐
│ Tabs: [输出] [Shotlist] [时间线] [参数]                                        │
│                                                                               │
│ 输出：                                                                        │
│   [播放器/缩略卡片]   [版本 ▾]  [下载] [复制链接]                              │
│                                                                               │
│ Shotlist：                                                                    │
│   表格：# 场景 | 镜头 | 描述 | 风格 | 时长                                    │
│   [从分镜生成]  [应用到分镜]                                                   │
│                                                                               │
│ 时间线：                                                                      │
│   轨道视图（片段/转场/字幕）；处理中禁用编辑并显示占位说明                    │
│                                                                               │
│ 参数（只读）：主题/画幅/拼接/素材源/音频/字幕…                                 │
│                                                                               │
│ 右上角动作（占位）：[保存为模板] [复刻为新任务]（先展示，功能后续实现）        │
└───────────────────────────────────────────────────────────────────────────────┘
┌───────────────────────────────────────────────────────────────────────────────┐
│ 日志（底部条，方案 B）： [展开 ▾]  最近 3 行                                   │
│ 展开后抽屉：自动滚动/暂停/清空/复制；状态为处理中时默认“自动滚动”开启         │
└───────────────────────────────────────────────────────────────────────────────┘
```

交互规则
- 头部状态：统一进度条/状态/主操作；失败时显示错误信息条，成功显示下载动作组。
- Tabs：避免卡片堆叠；切换不会丢失子区滚动位置；`/tasks` 与 `/edit/video/tasks` 双路径兼容。
- 日志：底部单行预览 + 抽屉；有“自动滚动/暂停/复制”控件；成功后保持可手动展开。
- Shotlist/时间线：保留现能力；紧凑样式（减小行距/边框），处理进行中显示禁用态说明。
- 二次动作：展示“保存为模板/复刻为新任务”的按钮（占位），点击先 toast“稍后上线”。

---

## 受影响的代码与改造点
- 创建页：`web/app/(studio)/create/page.tsx`
  - 改为两栏布局：左表单（分组折叠）+ 右预览/摘要；页底 Sticky 操作条。
  - 关键词改为 chip 输入（轻量实现：基于 Input + 小标签列表）。
  - 顶部预设 chip：写入画幅/时长/拼接/转场默认值。
- 任务详情：`web/components/tasks/task-detail-client.tsx`
  - 顶部状态条：进度/失败提示/主操作。
  - 主区 Tabs：输出/Shotlist/时间线/参数。
  - 底部日志抽屉：默认收起预览行，可展开；自动滚动控制。
  - 右上角“保存为模板/复刻为新任务”按钮（占位）。
- Shotlist 编辑：`web/components/tasks/shotlist-editor.tsx`
  - 收紧列宽与行距；字段长度限制与占位提示优化；错误高亮保持。
- 时间线：`web/components/timeline/mvp-timeline.tsx`
  - 外层包裹禁用态与占位说明（处理中时不可编辑）。

不改动：后端接口与 `lib/schemas.ts` 数据结构；任务创建与轮询逻辑沿用。

---

## 响应式与可访问性
- 移动端创建页：单栏纵向，右栏摘要/预览下沉；仅保留页底 Sticky 操作。
- 移动端详情页：Tabs 可横向滚动；日志以底部抽屉展示。
- a11y：焦点可见（ring-2）、Tab 顺序合理、Escape 关闭抽屉、Enter 提交表单。
- i18n：新增文案统一放入 `web/i18n/*`，复用现有 i18n 管理。

---

## 渐进式落地计划
1) 布局骨架与交互
   - 创建页两栏 + Sticky；详情页 Tabs + 底部日志抽屉。
2) 组件收紧与易用性
   - chip 输入、分组折叠持久化、禁用/空态/错误样式统一。
3) 二次动作与模板占位
   - 展示“保存为模板/复刻为新任务”，点击给出提示。

每一步均保持可用与无破坏（接口/数据不变），可随时回滚。

---

## 验收标准（本重构范围）
- 创建页：两栏布局生效；预设可一键写入；关键词为 chip 输入；默认分组展开规则符合确认。
- 详情页：顶部状态条统一；Tabs 可用且内容分离；底部日志可展开抽屉并自动滚动；二次动作入口可见。
- 可用性：移动端可正常操作；表单与日志无明显卡顿；失败/加载状态清晰。

---

## 变更追踪与实现提示
- 遵循 `docs/web-ui-ux-implementation-plan.md` 的主题/密度/分隔线规范；优先使用语义色类。
- 不新增全局依赖；chip 输入优先用本地轻量实现，后续可拆到 `components/ui/form/*`。
- 与任务中心复用：`/tasks` 与 `/edit/video/tasks` 保持路径感知（已实现的 basePath 逻辑不变）。

```text
落地路径
- 创建页骨架 → chip 输入 → 详情页 Tabs → 日志抽屉 → 样式收紧
```

> 注：本方案与 `docs/web-aigc-multi-tool-product-plan.md`、`docs/web-ui-ux-implementation-plan.md` 一致，作为“视频剪辑”场景的具体化实现规范。

